<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>AI Chat Exporter ì„¤ì •</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; color: #333; }

    .container { display: flex; max-width: 960px; margin: 20px auto; gap: 16px; }

    /* ì™¼ìª½: ì‚¬ì´íŠ¸ ëª©ë¡ */
    .site-list { width: 220px; background: white; border-radius: 8px; padding: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .site-list h3 { font-size: 14px; margin-bottom: 10px; color: #555; }
    .site-item { padding: 8px 10px; border-radius: 6px; cursor: pointer; font-size: 13px; margin-bottom: 4px; display: flex; align-items: center; gap: 6px; }
    .site-item:hover { background: #e8f0fe; }
    .site-item.active { background: #007bff; color: white; }
    .site-item .site-emoji { font-size: 16px; }

    .btn-group { margin-top: 12px; display: flex; flex-direction: column; gap: 6px; }
    .btn { padding: 7px 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; text-align: center; }
    .btn-add { background: #28a745; color: white; }
    .btn-add:hover { background: #218838; }
    .btn-reset { background: #6c757d; color: white; }
    .btn-reset:hover { background: #5a6268; }
    .btn-delete { background: #dc3545; color: white; }
    .btn-delete:hover { background: #c82333; }

    /* ì˜¤ë¥¸ìª½: í¸ì§‘ í¼ */
    .edit-panel { flex: 1; background: white; border-radius: 8px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .edit-panel h3 { font-size: 16px; margin-bottom: 16px; color: #333; }
    .form-group { margin-bottom: 14px; }
    .form-group label { display: block; font-size: 12px; color: #666; margin-bottom: 4px; font-weight: 600; }
    .form-group input, .form-group textarea { width: 100%; padding: 8px 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px; font-family: 'Consolas', 'Monaco', monospace; }
    .form-group textarea { height: 60px; resize: vertical; }
    .form-group .hint { font-size: 11px; color: #999; margin-top: 3px; }

    .form-row { display: flex; gap: 12px; }
    .form-row .form-group { flex: 1; }

    .save-bar { margin-top: 16px; display: flex; gap: 8px; justify-content: flex-end; }
    .btn-save { background: #007bff; color: white; padding: 8px 24px; font-size: 13px; }
    .btn-save:hover { background: #0056b3; }

    .empty-state { text-align: center; color: #999; padding: 40px; font-size: 14px; }

    /* íƒ­ ë‚´ë¹„ê²Œì´ì…˜ */
    .tab-nav { display: flex; gap: 2px; margin-bottom: 0; }
    .tab-btn { padding: 8px 16px; border: none; border-radius: 6px 6px 0 0; cursor: pointer; font-size: 13px; font-weight: 600; background: #e0e0e0; color: #666; }
    .tab-btn.active { background: #007bff; color: white; }
    .tab-btn:hover:not(.active) { background: #d0d0d0; }

    /* ì¶œë ¥ í˜•ì‹ íŒ¨ë„ */
    .format-panel { background: white; border-radius: 0 8px 8px 8px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .format-panel h3 { font-size: 16px; margin-bottom: 16px; color: #333; }
    .preview-box { background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 6px; padding: 12px; font-family: 'Consolas', 'Monaco', monospace; font-size: 12px; white-space: pre-wrap; word-break: break-all; color: #555; max-height: 200px; overflow-y: auto; margin-top: 8px; }

    /* ì•Œë¦¼ */
    .toast { position: fixed; top: 20px; right: 20px; padding: 10px 20px; background: #28a745; color: white; border-radius: 6px; font-size: 13px; opacity: 0; transition: opacity 0.3s; z-index: 100; }
    .toast.show { opacity: 1; }

    /* userAttribute í¸ì§‘ ì˜ì—­ */
    .attr-type-select { margin-bottom: 8px; }
    .attr-type-select select { padding: 6px 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px; }
    .attr-fields { display: flex; gap: 8px; flex-wrap: wrap; }
    .attr-fields input { flex: 1; min-width: 120px; }
  </style>
</head>
<body>
  <div style="max-width: 960px; margin: 20px auto; padding: 0 16px;">
    <div class="tab-nav">
      <button class="tab-btn active" id="tabFormat">ì¶œë ¥ í˜•ì‹</button>
      <button class="tab-btn" id="tabSites">ì‚¬ì´íŠ¸ ì„¤ì •</button>
    </div>
  </div>

  <!-- ì¶œë ¥ í˜•ì‹ íƒ­ -->
  <div id="formatTab" style="max-width: 960px; margin: 0 auto; padding: 0 16px;">
    <div class="format-panel">
      <h3>ì¶œë ¥ í˜•ì‹ ì„¤ì •</h3>

      <div class="form-row">
        <div class="form-group">
          <label>ì‘ì„±ì ì´ë¦„ (author)</label>
          <input type="text" id="fmtAuthor" placeholder="ì˜ˆ: í™ê¸¸ë™">
          <div class="hint">frontmatterì˜ {author}ì— ì‚½ì…ë©ë‹ˆë‹¤</div>
        </div>
        <div class="form-group">
          <label>ì´ë©”ì¼ (email)</label>
          <input type="text" id="fmtEmail" placeholder="ì˜ˆ: user@gmail.com">
          <div class="hint">frontmatterì˜ {email}ì— ì‚½ì…ë©ë‹ˆë‹¤</div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>ì €ì¥ ê²½ë¡œ (í•˜ìœ„ í´ë”)</label>
          <input type="text" id="fmtSavePath" placeholder="ì˜ˆ: AI-Chats/exports">
          <div class="hint">ë‹¤ìš´ë¡œë“œ í´ë” ê¸°ì¤€ í•˜ìœ„ ê²½ë¡œ. ë¹„ì›Œë‘ë©´ ê¸°ë³¸ ë‹¤ìš´ë¡œë“œ í´ë”ì— ì €ì¥ë©ë‹ˆë‹¤.</div>
        </div>
        <div class="form-group">
          <label>íŒŒì¼ëª… í˜•ì‹</label>
          <input type="text" id="fmtFilename" value="{model}_{title}_{date}">
          <div class="hint">ë³€ìˆ˜: {title}, {model}, {date} (20260225), {time} (143022), {datetime} (20260225_143022). í™•ì¥ì .mdëŠ” ìë™ ì¶”ê°€ë©ë‹ˆë‹¤.</div>
        </div>
      </div>

      <div class="form-group">
        <label>íŒŒì¼ëª… ë¯¸ë¦¬ë³´ê¸°</label>
        <div class="preview-box" id="filenamePreview" style="max-height: 40px;"></div>
      </div>

      <div class="form-group">
        <label>Frontmatter</label>
        <textarea id="fmtFrontmatter" rows="8" style="height:auto;">---
title: {title}
model: {model}
author: {author}
email: {email}
url: {url}
createdAt: {createdAt}
messageCount: {messageCount}
tags: []
---</textarea>
        <div class="hint">ì‚¬ìš© ê°€ëŠ¥í•œ ë³€ìˆ˜: {title} = í˜ì´ì§€ ì œëª©, {model} = AI ì´ë¦„, {author} = ì‘ì„±ì, {email} = ì´ë©”ì¼, {url} = í˜ì´ì§€ URL, {createdAt} = ìƒì„± ì¼ì‹œ, {messageCount} = ë©”ì‹œì§€ ìˆ˜. ë¹„ì›Œë‘ë©´ frontmatter ì—†ì´ ì¶œë ¥ë©ë‹ˆë‹¤.</div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>ì‚¬ìš©ì íƒ€ì´í‹€ í˜•ì‹</label>
          <input type="text" id="fmtUserTitle" value="### ğŸ‘¤ ì‚¬ìš©ì (User)">
          <div class="hint">ì‚¬ìš©ì ë©”ì‹œì§€ ì•ì— í‘œì‹œë˜ëŠ” ì œëª© ë¼ì¸</div>
        </div>
        <div class="form-group">
          <label>AI íƒ€ì´í‹€ í˜•ì‹</label>
          <input type="text" id="fmtAiTitle" value="### {emoji} {authorLabel}">
          <div class="hint">ì‚¬ìš© ê°€ëŠ¥í•œ ë³€ìˆ˜: {emoji}, {authorLabel} (ì‚¬ì´íŠ¸ë³„ ìë™ ì¹˜í™˜)</div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>ì‚¬ìš©ì-AI ì±„íŒ… êµ¬ë¶„ì</label>
          <input type="text" id="fmtTurnSeparator" value="---">
          <div class="hint">ì‚¬ìš©ì ë©”ì‹œì§€ì™€ AI ì‘ë‹µ ì‚¬ì´ì˜ êµ¬ë¶„ì„ </div>
        </div>
        <div class="form-group">
          <label>ì§ˆë¬¸-ì‘ë‹µ ì„¸íŠ¸ êµ¬ë¶„ì</label>
          <input type="text" id="fmtQaSeparator" value="---">
          <div class="hint">í•˜ë‚˜ì˜ Q&amp;A ì„¸íŠ¸ì™€ ë‹¤ìŒ ì„¸íŠ¸ ì‚¬ì´ì˜ êµ¬ë¶„ì„ </div>
        </div>
      </div>

      <div class="form-group">
        <label>ë¯¸ë¦¬ë³´ê¸°</label>
        <div class="preview-box" id="formatPreview"></div>
      </div>

      <div class="save-bar">
        <button class="btn btn-reset" id="resetFormatBtn">ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”</button>
        <button class="btn btn-save" id="saveFormatBtn">ì €ì¥</button>
      </div>
    </div>
  </div>

  <!-- ì‚¬ì´íŠ¸ ì„¤ì • íƒ­ -->
  <div id="sitesTab" style="max-width: 960px; margin: 0 auto; padding: 0 16px; display: none;">
  <div class="container">
    <div class="site-list">
      <h3>ì‚¬ì´íŠ¸ ëª©ë¡</h3>
      <div id="siteListItems"></div>
      <div class="btn-group">
        <button class="btn btn-add" id="addSiteBtn">+ ìƒˆ ì‚¬ì´íŠ¸ ì¶”ê°€</button>
        <button class="btn btn-reset" id="resetBtn">ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”</button>
      </div>
    </div>

    <div class="edit-panel" id="editPanel">
      <div class="empty-state" id="emptyState">ì™¼ìª½ì—ì„œ ì‚¬ì´íŠ¸ë¥¼ ì„ íƒí•˜ì„¸ìš”.</div>
      <div id="editForm" style="display:none;">
        <h3 id="editTitle">ì‚¬ì´íŠ¸ ì„¤ì •</h3>

        <div class="form-row">
          <div class="form-group">
            <label>ì‚¬ì´íŠ¸ ID</label>
            <input type="text" id="cfgId" placeholder="ì˜ˆ: chatgpt">
            <div class="hint">ê³ ìœ  ì‹ë³„ì (ì˜ë¬¸, ë³€ê²½ ë¶ˆê°€)</div>
          </div>
          <div class="form-group">
            <label>ì‚¬ì´íŠ¸ ì´ë¦„</label>
            <input type="text" id="cfgName" placeholder="ì˜ˆ: ChatGPT">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Hostname</label>
            <input type="text" id="cfgHostname" placeholder="ì˜ˆ: chatgpt.com">
            <div class="hint">URLì˜ í˜¸ìŠ¤íŠ¸ëª… (ë¶€ë¶„ ë§¤ì¹­)</div>
          </div>
          <div class="form-group">
            <label>ì´ëª¨ì§€</label>
            <input type="text" id="cfgEmoji" placeholder="ì˜ˆ: ğŸ¤–" style="width: 60px;">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>AI í‘œì‹œ ì´ë¦„</label>
            <input type="text" id="cfgAuthorLabel" placeholder="ì˜ˆ: ì±—GPT (ChatGPT)">
          </div>
          <div class="form-group">
            <label>ì œëª© ì ‘ë‘ì‚¬</label>
            <input type="text" id="cfgTitlePrefix" placeholder="ì˜ˆ: ChatGPT ëŒ€í™” ë‚´ì—­">
          </div>
        </div>

        <div class="form-group">
          <label>ë©”ì‹œì§€ ì…€ë ‰í„° (messageSelector)</label>
          <input type="text" id="cfgMessageSelector" placeholder="ì˜ˆ: [data-message-author-role]">
          <div class="hint">ëŒ€í™” ë©”ì‹œì§€ ëª©ë¡ì„ ê°€ì ¸ì˜¬ CSS ì…€ë ‰í„°</div>
        </div>

        <div class="form-group">
          <label>ì‚¬ìš©ì íŒë³„ ë°©ì‹ (userAttribute)</label>
          <div class="attr-type-select">
            <select id="cfgUserAttrType">
              <option value="attr">ì†ì„±ê°’ ë¹„êµ (attr + value)</option>
              <option value="tag">íƒœê·¸ëª… ë¹„êµ (tag)</option>
              <option value="container">ì»¨í…Œì´ë„ˆ í´ë˜ìŠ¤ (containerSelector)</option>
              <option value="htmlMatch">HTML í‚¤ì›Œë“œ ë§¤ì¹­ (htmlMatch)</option>
            </select>
          </div>
          <div id="attrFields"></div>
        </div>

        <div class="form-group">
          <label>ì½˜í…ì¸  ì…€ë ‰í„° (contentSelector)</label>
          <input type="text" id="cfgContentSelector" placeholder="ë¹„ì›Œë‘ë©´ ë©”ì‹œì§€ ìš”ì†Œ ìì²´ë¥¼ ì‚¬ìš©">
          <div class="hint">ë©”ì‹œì§€ ë‚´ ì‹¤ì œ ì½˜í…ì¸  ì˜ì—­ (ë¹„ì›Œë‘ë©´ ë©”ì‹œì§€ ìì²´ ì‚¬ìš©)</div>
        </div>

        <div class="form-group">
          <label>ì œê±°í•  ìš”ì†Œ ì…€ë ‰í„° (ignoreSelector)</label>
          <input type="text" id="cfgIgnoreSelector" placeholder="ì˜ˆ: button, svg, img">
          <div class="hint">ë§ˆí¬ë‹¤ìš´ ë³€í™˜ ì‹œ ì œê±°í•  UI ìš”ì†Œë“¤</div>
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" id="cfgDeduplicate"> ì¤‘ë³µ ì œê±° (deduplicate)
          </label>
          <div class="hint">ê°™ì€ í…ìŠ¤íŠ¸ì˜ ë©”ì‹œì§€ë¥¼ ì¤‘ë³µ ì œê±°</div>
        </div>

        <div class="save-bar">
          <button class="btn btn-delete" id="deleteSiteBtn">ì´ ì‚¬ì´íŠ¸ ì‚­ì œ</button>
          <button class="btn btn-save" id="saveBtn">ì €ì¥</button>
        </div>
      </div>
    </div>
  </div>
  </div>

  <div class="toast" id="toast"></div>

  <script src="config.js"></script>
  <script src="options.js"></script>
</body>
</html>